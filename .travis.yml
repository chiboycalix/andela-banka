# language: node_js
# node_js: 
#   - "stable"
# cache:
#   directories:
#     - "node_modules"

# services:
#   - postgresql

# after_success: npm run coverage
# # single test suite, non-parallel build.

# env:
#   global:
#     # - CC_TEST_REPORTER_ID=15cacf1692e34e33bedddb59a974a5263f8f4861c5a294b1373093ec4ef4e50a
#     - SECRET=15cacf1692e34e33bedddb59a974a5263f8f4861c5a294b1373093ec4ef4e50a
#     # - NODE_ENV=test
#     # - DATABASE_URL=postgres://ipdqiyjw:yza9WSaHrWILJ3OCeNskRkQ3wVbRaAQL@isilo.db.elephantsql.com:5432/ipdqiyj
# rvm:
#   - 2.2.0
# before_script:
#   - psql -c 'CREATE DATABASE banka_test;' -U postgres
#   - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
#   - chmod +x ./cc-test-reporter
#   - ./cc-test-reporter before-build

# script:
#   - nyc --reporter=lcov npm run test
# after_script:
#   - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
# notifications:
#   email: false

language: node_js
node_js:
  - "stable"
install:
  - npm install
services:
  - postgresql
env:
  global:
    - SECRET=15cacf1692e34e33bedddb59a974a5263f8f4861c5a294b1373093ec4ef4e50a
before_script:
  - psql -c 'create database banka;' -U postgres
  - chmod 0777 ./node_modules/.bin/mocha
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
script:
  - npm test
cache:
  directories:
    - "node_modules"
after_success:
  - npm run coverage
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT