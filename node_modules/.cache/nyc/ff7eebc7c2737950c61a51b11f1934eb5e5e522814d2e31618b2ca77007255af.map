{"version":3,"sources":["isStaff.js"],"names":["dotenv","config","isStaff","request","response","next","token","headers","authorization","split","decoded","jwt","verify","process","env","SECRET","userData","type","status","json","error"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEAA,iBAAOC,MAAP;;AAEA,IAAMC,UAAU,SAAVA,OAAU,CAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAC3C,MAAMC,QAAQH,QAAQI,OAAR,CAAgBC,aAAhB,CAA8BC,KAA9B,CAAoC,GAApC,EAAyC,CAAzC,CAAd;AACA,MAAMC,UAAUC,uBAAIC,MAAJ,CAAWN,KAAX,EAAkBO,QAAQC,GAAR,CAAYC,MAA9B,CAAhB;AACAZ,UAAQa,QAAR,GAAmBN,OAAnB;AAH2C,MAInCO,IAJmC,GAI1Bd,QAAQa,QAJkB,CAInCC,IAJmC;;AAK3C,MAAIA,SAAS,OAAb,EAAsB;AACpB,WAAOb,SAASc,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BD,cAAQ,GADuB;AAE/BE,aAAO;AAFwB,KAA1B,CAAP;AAID;AACDf;AACD,CAZD;;kBAceH,O","file":"isStaff.js","sourceRoot":"C:/Users/nono.DESKTOP-OPOSFU3/Desktop/andela-banka/server/middlewares","sourcesContent":["import jwt from 'jsonwebtoken';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nconst isStaff = (request, response, next) => {\n  const token = request.headers.authorization.split(' ')[1];\n  const decoded = jwt.verify(token, process.env.SECRET);\n  request.userData = decoded;\n  const { type } = request.userData;\n  if (type !== 'staff') {\n    return response.status(401).json({\n      status: 401,\n      error: 'Only a staff can perform this operation',\n    });\n  }\n  next();\n};\n\nexport default isStaff;\n"]}