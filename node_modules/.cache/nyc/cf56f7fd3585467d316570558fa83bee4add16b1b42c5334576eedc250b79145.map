{"version":3,"sources":["loginValidations.js"],"names":["loginValidation","request","response","next","body","email","password","pattern","i","users","length","status","json","error","match"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,kBAAkB,SAAlBA,eAAkB,CAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAAA,sBACvBF,QAAQG,IADe;AAAA,MAC3CC,KAD2C,iBAC3CA,KAD2C;AAAA,MACpCC,QADoC,iBACpCA,QADoC;;AAEnD,MAAMC,UAAU,sJAAhB;AACA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,gBAAMC,MAA1B,EAAkCF,KAAK,CAAvC,EAA0C;AACxC,QAAI,CAACH,KAAL,EAAY;AACV,aAAOH,SAASS,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BD,gBAAQ,GADuB;AAE/BE,eAAO;AAFwB,OAA1B,CAAP;AAID;AACD,QAAI,CAACR,MAAMS,KAAN,CAAYP,OAAZ,CAAL,EAA2B;AACzB,aAAOL,SAASS,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BD,gBAAQ,GADuB;AAE/BE,eAAO;AAFwB,OAA1B,CAAP;AAID;AACD,QAAI,CAACP,QAAL,EAAe;AACb,aAAOJ,SAASS,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BD,gBAAQ,GADuB;AAE/BE,eAAO;AAFwB,OAA1B,CAAP;AAID;AACD,QAAIJ,gBAAMD,CAAN,EAASH,KAAT,KAAmBA,KAAvB,EAA8B;AAC5B,aAAOH,SAASS,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BD,gBAAQ,GADuB;AAE/BE,eAAO;AAFwB,OAA1B,CAAP;AAID;AACD,QAAIJ,gBAAMD,CAAN,EAASF,QAAT,KAAsBA,QAA1B,EAAoC;AAClC,aAAOJ,SAASS,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BD,gBAAQ,GADuB;AAE/BE,eAAO;AAFwB,OAA1B,CAAP;AAID;AACF;AACDV;AACD,CApCD;;kBAsCeH,e","file":"loginValidations.js","sourceRoot":"C:/Users/nono.DESKTOP-OPOSFU3/Desktop/andela-banka/server/middlewares","sourcesContent":["import users from '../db/users';\n\nconst loginValidation = (request, response, next) => {\n  const { email, password } = request.body;\n  const pattern = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  for (let i = 0; i < users.length; i += 1) {\n    if (!email) {\n      return response.status(400).json({\n        status: 400,\n        error: 'email is required',\n      });\n    }\n    if (!email.match(pattern)) {\n      return response.status(400).json({\n        status: 400,\n        error: 'Please provide a valid email',\n      });\n    }\n    if (!password) {\n      return response.status(400).json({\n        status: 400,\n        error: 'password is required to login',\n      });\n    }\n    if (users[i].email !== email) {\n      return response.status(404).json({\n        status: 404,\n        error: 'Email does or password incorrect',\n      });\n    }\n    if (users[i].password !== password) {\n      return response.status(404).json({\n        status: 404,\n        error: 'Email does or password incorrect',\n      });\n    }\n  }\n  next();\n};\n\nexport default loginValidation;\n"]}