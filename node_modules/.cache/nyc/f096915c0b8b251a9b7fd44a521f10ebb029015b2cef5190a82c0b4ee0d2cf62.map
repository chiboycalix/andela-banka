{"version":3,"sources":["accountsTest.js"],"names":["dotenv","config","should","chai","use","chaiHttp","describe","client","firstName","lastName","email","password","type","isAdmin","clientToken","jwt","sign","id","process","env","SECRET","expiresIn","it","done","request","server","post","send","end","response","have","status","body","be","a","property","data","account","accountNumber","createdOn","owner","balance","set","err","error","equal","staff","staffToken","updatedAccount","patch","get","delete"],"mappings":"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","file":"accountsTest.js","sourceRoot":"C:/Users/nono.DESKTOP-OPOSFU3/Desktop/andela-banka/server/test/userTests","sourcesContent":["/* eslint-disable no-unused-expressions */\r\n// eslint-disable-next-line no-unused-expressions\r\nimport chai from 'chai';\r\nimport chaiHttp from 'chai-http';\r\nimport dotenv from 'dotenv';\r\nimport jwt from 'jsonwebtoken';\r\nimport server from '../../app';\r\n\r\ndotenv.config();\r\n// eslint-disable-next-line no-unused-vars\r\nconst should = chai.should();\r\n\r\nchai.use(chaiHttp);\r\n\r\ndescribe('All Account tests', () => {\r\n  const client = {\r\n    firstName: 'chinonso',\r\n    lastName: 'calix',\r\n    email: 'igwechinonso@gmail.com',\r\n    password: 1234,\r\n    type: 'client',\r\n    isAdmin: false,\r\n  };\r\n  const clientToken = jwt.sign({\r\n    email: client.email,\r\n    id: client.id,\r\n    isAdmin: client.isAdmin,\r\n    type: client.type,\r\n  }, process.env.SECRET, { expiresIn: '1h' });\r\n  it('should be able to signup a user with correct details', (done) => {\r\n    chai.request(server)\r\n      .post('/api/v1/auth/signup')\r\n      .send('x-access-token', clientToken)\r\n      .send(client)\r\n      .end((request, response) => {\r\n        response.should.have.status(201);\r\n        response.body.should.be.a('object');\r\n        response.body.should.have.property('data');\r\n        response.body.data.should.have.property('token');\r\n        response.body.data.should.have.property('firstName');\r\n        response.body.data.should.have.property('lastName');\r\n        response.body.data.should.have.property('email');\r\n        response.body.data.should.have.property('password');\r\n        response.body.data.should.have.property('type');\r\n        response.body.data.should.have.property('isAdmin');\r\n        done();\r\n      });\r\n  });\r\n  const account = {\r\n    id: 1,\r\n    accountNumber: '0114276912',\r\n    createdOn: '12/12/2009',\r\n    owner: 1,\r\n    type: 'savings',\r\n    status: 'active',\r\n    balance: 50000.32,\r\n  };\r\n  it('only a logged in user should be able to create an account', (done) => {\r\n    chai.request(server)\r\n      .post('/api/v1/accounts')\r\n      .send(account)\r\n      .set('Authorization', `Bearer ${clientToken}`)\r\n      .end((err, response) => {\r\n        response.should.have.status(201);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('you should not be able to create account if you are not logged in', (done) => {\r\n    chai.request(server)\r\n      .post('/api/v1/accounts')\r\n      .send(account)\r\n      .end((err, response) => {\r\n        response.should.have.status(401);\r\n        response.body.should.have.property('error');\r\n        response.body.error.should.equal('Unauthorized');\r\n      });\r\n    done();\r\n  });\r\n\r\n  const staff = {\r\n    firstName: 'chinonso',\r\n    lastName: 'calix',\r\n    email: 'staff@gmail.com',\r\n    password: 1234,\r\n    type: 'staff',\r\n    isAdmin: true,\r\n  };\r\n  const staffToken = jwt.sign({\r\n    email: staff.email,\r\n    id: staff.id,\r\n    isAdmin: staff.isAdmin,\r\n    type: staff.type,\r\n  }, process.env.SECRET, { expiresIn: '1h' });\r\n  it('should be able to signup a staff with the correct details', (done) => {\r\n    chai.request(server)\r\n      .post('/api/v1/auth/signup')\r\n      .send('x-access-token', staffToken)\r\n      .send(staff)\r\n      .end((request, response) => {\r\n        response.should.have.status(201);\r\n        response.body.should.be.a('object');\r\n        response.body.should.have.property('data');\r\n        response.body.data.should.have.property('token');\r\n        response.body.data.should.have.property('firstName');\r\n        response.body.data.should.have.property('lastName');\r\n        response.body.data.should.have.property('email');\r\n        response.body.data.should.have.property('password');\r\n        response.body.data.should.have.property('type');\r\n        response.body.data.should.have.property('isAdmin');\r\n        done();\r\n      });\r\n  });\r\n  const updatedAccount = {\r\n    id: 1,\r\n    accountNumber: '0114276912',\r\n    createdOn: '12/12/2009',\r\n    owner: 1,\r\n    type: 'savings',\r\n    status: 'dormant',\r\n    balance: 50000.32,\r\n  };\r\n  it('only a staff can update an account', (done) => {\r\n    chai.request(server)\r\n      .patch('/api/v1/accounts/0114276912')\r\n      .send(updatedAccount)\r\n      .set('Authorization', `Bearer ${staffToken}`)\r\n      .end((err, response) => {\r\n        response.should.have.status(200);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('only an a staff should be able to get all accounts', (done) => {\r\n    chai.request(server)\r\n      .get('/api/v1/accounts')\r\n      .set('Authorization', `Bearer ${staffToken}`)\r\n      .end((err, response) => {\r\n        response.should.have.status(200);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('only an a staff should be able to get a single account number', (done) => {\r\n    chai.request(server)\r\n      .get('/api/v1/accounts/0114276912')\r\n      .set('Authorization', `Bearer ${staffToken}`)\r\n      .end((err, response) => {\r\n        response.should.have.status(200);\r\n      });\r\n    done();\r\n  });\r\n\r\n  it('only an a staff should be able to delete an account number', (done) => {\r\n    chai.request(server)\r\n      .delete('/api/v1/accounts/0114276912')\r\n      .set('Authorization', `Bearer ${staffToken}`)\r\n      .end((err, response) => {\r\n        response.should.have.status(200);\r\n      });\r\n    done();\r\n  });\r\n});\r\n"]}